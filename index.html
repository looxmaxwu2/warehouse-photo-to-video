<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fotoƒüraf ‚Üí Video D√∂n√º≈üt√ºr√ºc√º</title>
    <style>
        body { font-family: Arial, sans-serif; max-width: 800px; margin: 0 auto; padding: 20px; }
        .upload-area { border: 2px dashed #3498db; padding: 30px; text-align: center; cursor: pointer; }
        #preview { max-width: 100%; display: none; }
        #loading { display: none; }
        #downloadBtn { display: none; margin-top: 20px; }
    </style>
</head>
<body>
    <h1>Fotoƒürafƒ± Videoya D√∂n√º≈üt√ºr</h1>
    
    <div class="upload-area" id="uploadArea">
        <p>üì∑ Fotoƒürafƒ±nƒ±zƒ± s√ºr√ºkleyip bƒ±rakƒ±n veya tƒ±klayarak se√ßin</p>
        <input type="file" id="fileInput" accept="image/*" style="display: none;">
    </div>
    
    <div>
        <label for="duration">Video S√ºresi (saniye):</label>
        <input type="number" id="duration" value="3" min="1" max="10">
    </div>
    
    <div>
        <label for="format">Video Formatƒ±:</label>
        <select id="format">
            <option value="mp4">MP4</option>
            <option value="webm">WebM</option>
        </select>
    </div>
    
    <button id="convertBtn">Videoya D√∂n√º≈üt√ºr</button>
    
    <div id="loading">‚è≥ Video olu≈üturuluyor...</div>
    
    <video id="preview" controls></video>
    <a id="downloadBtn" download>üíæ Videoyu ƒ∞ndir</a>

    <!-- FFmpeg.js k√ºt√ºphanesi -->
    <script src="https://unpkg.com/@ffmpeg/ffmpeg@0.11.6/dist/ffmpeg.min.js"></script>
    
    <script>
        const { createFFmpeg, fetchFile } = FFmpeg;
        const ffmpeg = createFFmpeg({ log: true });
        
        const uploadArea = document.getElementById('uploadArea');
        const fileInput = document.getElementById('fileInput');
        const convertBtn = document.getElementById('convertBtn');
        const loadingDiv = document.getElementById('loading');
        const preview = document.getElementById('preview');
        const downloadBtn = document.getElementById('downloadBtn');
        
        let selectedFile = null;
        
        // Dosya se√ßimi
        uploadArea.addEventListener('click', () => fileInput.click());
        fileInput.addEventListener('change', () => {
            if (fileInput.files[0]) {
                selectedFile = fileInput.files[0];
                uploadArea.innerHTML = `<p>‚úÖ Se√ßilen dosya: ${selectedFile.name}</p>`;
            }
        });
        
        // D√∂n√º≈üt√ºrme butonu
        convertBtn.addEventListener('click', async () => {
            if (!selectedFile) return alert("L√ºtfen bir fotoƒüraf se√ßin!");
            
            const duration = document.getElementById('duration').value;
            const format = document.getElementById('format').value;
            
            loadingDiv.style.display = "block";
            convertBtn.disabled = true;
            
            try {
                // FFmpeg y√ºkleme
                if (!ffmpeg.isLoaded()) {
                    await ffmpeg.load();
                }
                
                // Dosyayƒ± FFmpeg'e y√ºkle
                ffmpeg.FS('writeFile', 'input.jpg', await fetchFile(selectedFile));
                
                // Video olu≈üturma komutu
                await ffmpeg.run(
                    '-loop', '1',
                    '-i', 'input.jpg',
                    '-t', duration,
                    '-vf', 'scale=640:-2',
                    '-c:v', format === 'mp4' ? 'libx264' : 'libvpx',
                    '-pix_fmt', 'yuv420p',
                    `output.${format}`
                );
                
                // Sonucu al
                const data = ffmpeg.FS('readFile', `output.${format}`);
                const videoUrl = URL.createObjectURL(
                    new Blob([data.buffer], { type: `video/${format}` })
                );
                
                // √ñnizleme g√∂ster
                preview.src = videoUrl;
                preview.style.display = "block";
                
                // ƒ∞ndirme butonunu ayarla
                downloadBtn.href = videoUrl;
                downloadBtn.download = `video.${format}`;
                downloadBtn.style.display = "inline-block";
                
            } catch (err) {
                console.error(err);
                alert("Hata olu≈ütu: " + err.message);
            } finally {
                loadingDiv.style.display = "none";
                convertBtn.disabled = false;
            }
        });
    </script>
</body>
</html>
